<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Math Helper Infinite</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }

    body {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      transition: background 0.4s, color 0.4s;
    }

    body.dark {
      background: radial-gradient(circle at top, #0f2027, #000);
      color: white;
    }

    body.light {
      background: radial-gradient(circle at top, #e0f7ff, #ffffff);
      color: #111;
    }

    .card {
      position: relative;
      z-index: 1;
      padding: 40px;
      border-radius: 20px;
      text-align: center;
      width: 360px;
      backdrop-filter: blur(10px);
    }

    body.dark .card {
      background: rgba(0, 0, 0, 0.6);
      box-shadow: 0 0 30px #00ffff55;
    }

    body.light .card {
      background: rgba(255, 255, 255, 0.85);
      box-shadow: 0 0 30px #00000022;
    }

    input, button, select {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: none;
      margin-bottom: 10px;
      font-size: 1rem;
    }

    body.dark input {
      background: #111;
      color: cyan;
    }

    body.light input {
      background: #f0f0f0;
      color: #000;
    }

    body.dark button {
      background: linear-gradient(135deg, cyan, #00ff88);
      color: black;
      cursor: pointer;
    }

    body.light button {
      background: linear-gradient(135deg, #333, #666);
      color: white;
      cursor: pointer;
    }

    .section {
      margin-top: 15px;
      text-align: left;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }

    .site {
      padding: 8px;
      background: rgba(255,255,255,0.15);
      border-radius: 8px;
      cursor: pointer;
      text-align: center;
      font-size: 0.9rem;
    }

    #settings-modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      align-items: center;
      justify-content: center;
    }

    .settings-content {
      background: white;
      padding: 25px;
      border-radius: 10px;
      width: 300px;
    }
  </style>
</head>

<body class="dark">
  <div class="card">
    <h1>MATH HELPER âˆž</h1>
    <p>INFINITE FREEDOM</p>

    <input id="input" type="text" placeholder="Go anywhere...">
    <button id="go">GO</button>

    <select id="engine">
      <option value="duckduckgo">DuckDuckGo</option>
      <option value="bing">Bing</option>
      <option value="google">Google</option>
    </select>

    <div class="section">
      <h3>Favorites</h3>
      <div class="grid" id="favorites"></div>
    </div>

    <div class="section">
      <h3>Recent</h3>
      <div class="grid" id="recent"></div>
    </div>

    <button onclick="openSettings()">Settings</button>
  </div>

  <div id="settings-modal">
    <div class="settings-content">
      <h3>Settings</h3>
      <select id="theme-select">
        <option value="light">Light</option>
        <option value="dark">Dark</option>
      </select>

      <select id="engine-select">
        <option value="duckduckgo">DuckDuckGo</option>
        <option value="bing">Bing</option>
        <option value="google">Google</option>
      </select>

      <button onclick="saveSettings()">Save</button>
      <button onclick="closeSettings()">Close</button>
    </div>
  </div>

  <script>
    const favorites = JSON.parse(localStorage.getItem("favorites")) || [
      { name: "Google", url: "https://google.com" },
      { name: "YouTube", url: "https://youtube.com" },
      { name: "GitHub", url: "https://github.com" },
      { name: "Wikipedia", url: "https://wikipedia.org" }
    ];

    const recent = JSON.parse(localStorage.getItem("recent")) || [];

    const input = document.getElementById("input");
    const engine = document.getElementById("engine");

    function save() {
      localStorage.setItem("favorites", JSON.stringify(favorites));
      localStorage.setItem("recent", JSON.stringify(recent));
    }

    function renderGrid(el, items) {
      el.innerHTML = "";
      items.forEach(site => {
        const div = document.createElement("div");
        div.className = "site";
        div.textContent = site.name;
        div.onclick = () => openSite(site.url, site.name);
        el.appendChild(div);
      });
    }

    renderGrid(document.getElementById("favorites"), favorites);
    renderGrid(document.getElementById("recent"), recent);

    function openSite(url, name) {
      recent.unshift({ name, url });
      if (recent.length > 8) recent.pop();
      save();
      renderGrid(document.getElementById("recent"), recent);

      const a = document.createElement("a");
      a.href = url;
      a.target = "_blank";
      a.rel = "noopener noreferrer";
      document.body.appendChild(a);
      a.click();
      a.remove();
    }

    function launch() {
      const value = input.value.trim();
      if (!value) return;

      let url;
      if (/^https?:\/\//i.test(value)) {
        url = value;
      } else if (value.includes(".") && !value.includes(" ")) {
        url = "https://" + value;
      } else {
        const q = encodeURIComponent(value);
        url = {
          duckduckgo: `https://108.181.9.39/?ko=s&q= &ia=web&__cpo=aHR0cHM6Ly9kdWNrZHVja2dvLmNvb`,
          bing: `https://108.181.9.39/?ko=s&q= &ia=web&__cpo=aHR0cHM6Ly9kdWNrZHVja2dvLmNvbQ`,
          google: `https://108.181.9.39/?ko=s&q= &ia=web&__cpo=aHR0cHM6Ly9kdWNrZHVja2dvLmNvb`
        }[engine.value];
      }

      openSite(url, value);
    }

    document.getElementById("go").onclick = launch;
    input.addEventListener("keydown", e => e.key === "Enter" && launch());

    function openSettings() {
      document.getElementById("settings-modal").style.display = "flex";
    }

    function closeSettings() {
      document.getElementById("settings-modal").style.display = "none";
    }

    function saveSettings() {
      const theme = document.getElementById("theme-select").value;
      const eng = document.getElementById("engine-select").value;

      document.body.className = theme;
      engine.value = eng;

      localStorage.setItem("theme", theme);
      localStorage.setItem("engine", eng);

      closeSettings();
    }

    // Load saved settings
    const savedTheme = localStorage.getItem("theme");
    const savedEngine = localStorage.getItem("engine");
    if (savedTheme) document.body.className = savedTheme;
    if (savedEngine) engine.value = savedEngine;
  </script>
</body>
</html>